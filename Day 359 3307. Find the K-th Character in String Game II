class Solution {
    public char kthCharacter(long k, int[] operations) {
        int n = operations.length;
        long[] len = new long[n + 1];
        len[0] = 1L;
        for (int i = 0; i < n; i++) {
            len[i + 1] = len[i] >= k ? len[i] : Math.min(k, len[i] * 2);
        }

        long pos = k - 1;
        int shift = 0;

        for (int i = n; i >= 1; i--) {
            long half = len[i - 1];
            if (pos >= half) {
                pos -= half;
                if (operations[i - 1] == 1) shift++;
            }
        }

        return (char) ('a' + (shift % 26));
    }
}
